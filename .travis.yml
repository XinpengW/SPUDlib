language: c
compiler:
  - clang
  - gcc

env:
  - COVERAGE=true
  - COVERAGE=false;

matrix:
  exclude:
    - compiler: clang 
      env: COVERAGE=true
    - compiler: gcc
      env: COVERAGE=false

before_install:
 - sudo apt-get install check
 - sudo apt-get install -y lcov
 - gem install coveralls-lcov

# Change this to your needs
script: 
  - ./bootstrap.sh
  - ./configure --with-check && make && make check

after_success:
- if [[ $COVERAGE == 'true' ]]; 
  then 
  ./configure --with-check --enable-gcov && make clean && make check;
  lcov -d . --capture --directory src --output-file spudlib.info;
  coveralls-lcov spudlib.info; 
  fi
 